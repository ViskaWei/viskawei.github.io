---
import BaseLayout from '../layouts/BaseLayout.astro';
import '../styles/skilltree.css';
---

<BaseLayout title="Skills Hub â€” Viska Wei" description="Interactive dashboard of Claude AI skills">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet" />

  <div class="galaxy-page">
    <!-- TOP HUD BAR -->
    <header class="stellaris-top-bar">
      <div class="top-bar-resources">
        <div class="resource-counter" style="--rc-color: #4fc3f7">
          <span class="material-symbols-outlined resource-icon">hub</span>
          <span class="resource-label">TOTAL</span>
          <span class="resource-value" id="total-count">0</span>
        </div>
        <div class="resource-counter" style="--rc-color: #66bb6a">
          <span class="material-symbols-outlined resource-icon">park</span>
          <span class="resource-label">MATURE</span>
          <span class="resource-value" id="mature-count">0</span>
        </div>
        <div class="resource-counter" style="--rc-color: #ffd54f">
          <span class="material-symbols-outlined resource-icon">eco</span>
          <span class="resource-label">GROWING</span>
          <span class="resource-value" id="growing-count">0</span>
        </div>
        <div class="resource-counter" style="--rc-color: #ef5350">
          <span class="material-symbols-outlined resource-icon">water_drop</span>
          <span class="resource-label">SEEDLING</span>
          <span class="resource-value" id="seedling-count">0</span>
        </div>
      </div>
      <div class="top-bar-controls">
        <div class="resource-counter" style="--rc-color: #ab47bc">
          <span class="material-symbols-outlined resource-icon">code</span>
          <span class="resource-label">EMPTY</span>
          <span class="resource-value" id="empty-count">0</span>
        </div>
        <div class="top-bar-divider"></div>
        <button class="hud-icon-btn" id="view-toggle" title="Toggle View">
          <span class="material-symbols-outlined">bubble_chart</span>
        </button>
      </div>
    </header>

    <!-- MAIN CONTAINER -->
    <div class="galaxy-container" id="skills-root">
      <!-- Source filter strip (left) -->
      <nav class="icon-strip">
        <button class="icon-strip-btn active" data-source="all" title="All Sources">
          <span class="material-symbols-outlined">apps</span>
        </button>
        <button class="icon-strip-btn" data-source="private" title="Private">
          <span class="material-symbols-outlined">lock</span>
        </button>
        <button class="icon-strip-btn" data-source="public" title="Public">
          <span class="material-symbols-outlined">public</span>
        </button>
        <button class="icon-strip-btn" data-source="scientific" title="Scientific">
          <span class="material-symbols-outlined">science</span>
        </button>
        <div class="icon-strip-spacer"></div>
        <button class="icon-strip-btn" data-source="local" title="Local">
          <span class="material-symbols-outlined">computer</span>
        </button>
      </nav>

      <!-- Skill detail panel (reuse galaxy-detail-panel styling) -->
      <div class="galaxy-detail-panel" id="skill-detail">
        <div class="hud-border">
          <div class="hud-corner tl"></div>
          <div class="hud-corner tr"></div>
          <div class="hud-corner bl"></div>
          <div class="hud-corner br"></div>
        </div>
        <button class="close-btn" aria-label="Close">&times;</button>
        <div class="detail-type-badge">SKILL</div>
        <h3 id="skill-name">Skill Name</h3>
        <div class="detail-code" id="skill-source">SOURCE</div>
        <div class="detail-meta">
          <span class="detail-institution-badge" id="skill-maturity">mature</span>
          <span class="detail-year" id="skill-version">v1.0</span>
        </div>
        <div class="detail-track" id="skill-description">Description here</div>
        <div class="detail-prereqs detail-section" id="skill-tags-section" style="display:none">
          <h4>Tags</h4>
          <div class="detail-list" id="skill-tags"></div>
        </div>
        <div class="detail-projects detail-section" id="skill-tools-section" style="display:none">
          <h4>Allowed Tools</h4>
          <div class="detail-list" id="skill-tools"></div>
        </div>
        <!-- Maturity bar -->
        <div style="margin-top: 1rem;">
          <div style="font-size: 0.7rem; color: var(--galaxy-text-dim); margin-bottom: 0.3rem;">MATURITY</div>
          <div style="background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; height: 6px;">
            <div id="skill-maturity-bar" style="height: 100%; border-radius: 4px; transition: width 0.3s;"></div>
          </div>
          <div id="skill-score" style="font-size: 0.7rem; color: var(--galaxy-text-dim); margin-top: 0.2rem;">0%</div>
        </div>
      </div>
    </div>

    <!-- BOTTOM HUD BAR -->
    <footer class="stellaris-bottom-bar">
      <div class="bottom-legend">
        <div class="legend-item">
          <span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:#4fc3f7"></span>
          <span>Mature</span>
        </div>
        <div class="legend-item">
          <span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:#66bb6a"></span>
          <span>Growing</span>
        </div>
        <div class="legend-item">
          <span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:#ffd54f"></span>
          <span>Seedling</span>
        </div>
        <div class="legend-item">
          <span style="display:inline-block;width:10px;height:10px;border-radius:50%;background:#ef5350"></span>
          <span>Empty</span>
        </div>
      </div>
      <div class="bottom-center">
        <a href="/background" class="close-galaxy-btn">
          <span class="close-galaxy-text">Open Galaxy Map</span>
        </a>
      </div>
      <div class="bottom-right">
        <div class="map-mode-btns">
          <button class="map-mode-btn active" id="btn-treemap" title="Treemap View">
            <span class="material-symbols-outlined">grid_view</span>
          </button>
          <button class="map-mode-btn" id="btn-force" title="Force View">
            <span class="material-symbols-outlined">bubble_chart</span>
          </button>
        </div>
        <div class="bottom-divider"></div>
        <div class="galaxy-zoom-controls">
          <button class="zoom-in" aria-label="Zoom in">+</button>
          <button class="zoom-out" aria-label="Zoom out">&minus;</button>
          <button class="zoom-reset" aria-label="Reset zoom">&#8634;</button>
        </div>
      </div>
    </footer>
  </div>
</BaseLayout>

<script>
  import { initSkillsHub } from '../islands/SkillsHub';
  import registry from '../data/skills-registry.json';

  const container = document.getElementById('skills-root');
  if (container) {
    initSkillsHub(container, registry);
  }
</script>
